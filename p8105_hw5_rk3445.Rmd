---
title: "p8105_hw5_rk3445"
author: "Rosie Kwon"
date: "2025-11-01"
output: html_document
---

```{r, include = FALSE, message = FALSE, warning = FALSE}
library(tidyverse)
library(rvest)

knitr::opts_chunk$set(
	echo = TRUE,
	warning = FALSE,
  fig.width = 6,
  fig.asp = .6,
  out.width = "90%"
)

theme_set(theme_minimal() + theme(legend.position = "bottom"))

options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)

scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
```

## Problem 1

A function that checks whether there are duplicate birthdays in the group
```{r}
duplicate_birthday = function(n) {
  birthdays = sample(1:365, n, replace = TRUE)
  
  repeated_bday = length(unique(birthdays)) < n
  
  repeated_bday
}
```

run this function 10000 times for each group size between 2 and 50. 
```{r}
#For each group size, compute the probability that at least two people in the group will share a birthday by averaging across the 10000 simulation runs.
sim_results =
  expand_grid(
    bdays = 2:50,
    iter = 1:10000
  ) |> 
  mutate(
    result = map_lgl(bdays, duplicate_birthday)
  ) |> 
  group_by(
    bdays
  ) |> 
  summarize(
    prob_repeat = mean(result)
  )
```

A plot showing the probability as a function of group size
```{r}
sim_results |>
  ggplot(aes(x = bdays, y = prob_repeat)) +
  geom_point(size = 1) + 
  geom_line(color = "darkorange", size = 1, alpha = 0.5) + 
  labs(
    title = "Probability that at least two people share a birthday",
    x = "Group Size",
    y = "Probability of Shared Birthday"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    plot.title = element_text(face = "bold")
  )
```

The plot shows the probability of at least two people sharing a birthday with group sizes ranging from 2 to 50. We observe that the probability is close to zero at small group sizes but increases rapidly between group sizes of 10 and 30. Beyond that, the slope of the curve begins to slow and after group size of 45 the probability approaches 1.0 , meaning that almost every group of more than 40 people will have at least two individuals sharing a birthday.



## Problem 2

simulation to explore power in a one-sample t-test.

Generate 5000 datasets from the normal distribution 
```{r}
sim_mean_sd = function(samp_size = 30, mu = 0 , sigma = 5){
  sim_df = 
    tibble(
      x = rnorm(n = samp_size, mean = mu, sd = sigma)
    )
  sim_df
}

sim_results =
  rerun(5000,sim_mean_sd(30,0,5)) |> 
  bind_rows()


```


```{r}
sim_mean_sd = function(samp_size = 30, mu = 0 , sigma = 5){
  x = rnorm(n = samp_size, mean = mu, sd = sigma)
  x
  x_mean = mean(x)
}

sim_results =
  rerun(5000,sim_mean_sd(30,0,5)) 
```


For each dataset, save ğœ‡Ì‚ 
 and the p-value arising from a test of ğ»:ğœ‡=0
 using ğ›¼=0.05
. Hint: to obtain the estimate and p-value, use broom::tidy to clean the output of t.test.

Repeat the above for ğœ‡={1,2,3,4,5,6}
, and complete the following:

Make a plot showing the proportion of times the null was rejected (the power of the test) on the y axis and the true value of ğœ‡
 on the x axis. Describe the association between effect size and power.
Make a plot showing the average estimate of ğœ‡Ì‚ 
 on the y axis and the true value of ğœ‡
 on the x axis. Make a second plot (or overlay on the first) the average estimate of ğœ‡Ì‚ 
 only in samples for which the null was rejected on the y axis and the true value of ğœ‡
 on the x axis. Is the sample average of ğœ‡Ì‚ 
 across tests for which the null is rejected approximately equal to the true value of ğœ‡
? Why or why not?

